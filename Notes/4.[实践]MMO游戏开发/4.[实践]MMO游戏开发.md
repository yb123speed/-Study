# 4.[实践]MMO游戏开发

## 4.1网络游戏开发的基础流程

## 4.2C/S MMO游戏的发展趋势和对策

C/S MMO特有的游戏内容：

- 处理大量数据
- 向玩家严格保密设定信息
- 严格维护游戏数据的更改内容
- 简单地进行设定信息的更改
- 易于结合SNS等其他服务系统

C/S MMO架构的限制：

- 延迟较大
- 游戏服务器的带宽负荷很高
- 游戏服务器的维护费用很高
- 服务器停止期间，无法进行游戏

## 4.3策划文档和5种设计文档

## 4.4系统基本结构图的制定

### 专栏——MMO客户端特有的渲染性能瓶颈

游戏客户端的瓶颈：游戏处理和渲染处理

渲染的处理速度在不同阶段中有锁不同：

- 从磁盘读取数据至主存中：非常缓慢。所需的时间以毫秒为单位。
- 从主存读取数据至GPU的内存中：较慢。所有的时间以微秒为单位。
- GPU内存内部的传输：非常快。完成时间以纳秒为单位。

因此，在GPU内部进行处理才能达到高速渲染。

一般游戏中的渲染尽可能全都在GPU中加载，之后在游戏过程中，所有内容的读取都尽量不要访问主存和磁盘。这一点是最基本的。

MMO中的渲染——玩家角色

- 不要“一口气读取所有必要的数据”，而是在保持帧速率的情况下花时间一点点读取。
- 即使是在读取纹理数据的过程中，也尽量只先进行轮廓的渲染，只对所处位置有所了解。

### 解决游戏服务器/数据库的瓶颈

解决服务器的瓶颈主要有以下两种方法：

1. 空间分割法（空间地理上的分割）

    根据地理结构将游戏世界进行分割，分割给其他的服务器进程或服务器设备进行处理。

2. 实例法（游戏副本实例）

    将负荷特别高的、用户集中在一起的部分独立出来，将这些部分分配给专用的服务器来处理。这些部分未必都是以游戏副本的形式来呈现，但典型情况下都是使用这种形式的，所以也称为游戏副本实例（instance dungeon）。

3. 平行世界方式

    使容易成为瓶颈的数据库本身并行化，以此将瓶颈分为多个。但是保存了玩家信息的数据库分成多个后，角色就无法在不同的世界之间移动，所以玩家之间的交流也被切断了。

上述3种方式也可以同时使用。WOW中就同时使用了上述3种方法，从而支持数百万玩家参与游戏。

#### K Online的设计估算——首先从同时在线开始

瓶颈的确认：

1. 客户端渲染性能的瓶颈
2. 用户侧线路带宽的瓶颈
3. 游戏服务器的逻辑处理性能的瓶颈
4. 游戏数据库写入性能的瓶颈

#### 服务器的基本结构

1. 收费认证服务器是通用的
2. 分割为5个平行时间，1个世界允许同时在线6000人，总共3w人同时访问
3. 1个世界分为8个地区（8核）
4. 1个世界准备360个实例
5. 玩家继续增加的情况下，追加平行世界

![进程关系图](https://raw.githubusercontent.com/yb123speed/The-core-technology-and-actual-combat-of-network-games-Study/master/Notes/Images/servers0x01.jpg)
